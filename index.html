<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>âœ¨ Tech Hotel Management âœ¨</title>
  <style>
    :root{
      --primary:#5b86e5;
      --accent:#36d1dc;
      --bg1:#FFDEE9;
      --bg2:#B5FFFC;
      --card:#ffffffcc;
      --muted:#666;
      --dark:#141E30;
    }
    html,body{height:100%;margin:0;font-family:Arial, Helvetica, sans-serif;overflow:hidden;}
    .root{height:100%;display:flex;align-items:flex-start;justify-content:center;background:linear-gradient(135deg,var(--bg1),var(--bg2));}
    .container{width:1200px;padding:30px;box-sizing:border-box}

    /* Table selection */
    .title{font-family:Verdana; font-weight:800; font-size:48px; color:darkblue; text-align:center}
    .instructions{font-weight:700; font-size:18px; color:#2f4f4f; text-align:center;margin:12px 0}
    .table-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:20px;justify-items:center;margin-top:20px}
    .table-btn{width:180px;height:70px;border:none;border-radius:20px;background:linear-gradient(90deg,#ff9966,#ff5e62);color:white;font-weight:800;font-size:20px;cursor:pointer;transition:0.2s}
    .table-btn:hover{transform: scale(1.05);box-shadow:0 6px 12px rgba(0,0,0,0.25)}

    /* Menu */
    .menu-layout{height:calc(100vh - 60px);display:flex;flex-direction:column}
    .topbar{display:flex;align-items:center;justify-content:flex-start}
    .back-btn{border:none;background:#ff5e62;color:white;padding:8px 14px;border-radius:10px;font-weight:700;cursor:pointer}
    .menu-box{padding:16px;overflow:auto;flex:1}
    .section{margin:24px 0;background:linear-gradient(135deg,#fbc2eb,#a6c1ee);padding:16px;border-radius:12px}
    .section h2{font-family:Verdana;color:darkblue;margin:0 0 10px 0}
    .items-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
    .item-btn{display:flex;align-items:center;justify-content:center;height:70px;border:none;border-radius:15px;background:linear-gradient(90deg,var(--accent),var(--primary));color:white;font-weight:700;font-size:16px;cursor:pointer;box-shadow:0 4px 8px rgba(0,0,0,0.15);transition:0.2s}
    .item-btn:hover{transform:translateY(-5px);box-shadow:0 8px 15px rgba(0,0,0,0.3)}

    .bottom-right{display:flex;justify-content:flex-end;padding:12px}
    .cart-btn{background:#f8b400;border:none;padding:10px 18px;border-radius:15px;font-weight:800;font-size:18px;cursor:pointer}

    /* Cart */
    .cart-layout{height:100vh;background:linear-gradient(180deg,#141E30,#243B55);color:white;padding:24px;box-sizing:border-box}
    .cart-title{font-family:Verdana;font-weight:800;font-size:28px;text-align:center}
    .cart-list{background:#f0f0f0;color:#111;padding:10px;border-radius:8px;height:50vh;overflow:auto;font-size:18px}
    .cart-controls{display:flex;gap:12px;justify-content:center;margin-top:12px}
    .btn{padding:10px 18px;border-radius:12px;border:none;cursor:pointer;font-weight:700}
    .reorder{background:#4CAF50;color:white}
    .delete{background:#f44336;color:white}
    .payment{background:#2196F3;color:white}
    .total{font-weight:800;margin-top:8px;color:lightyellow}

    /* Payment */
    .payment-layout{height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:40px;background:linear-gradient(180deg,#f12711,#f5af19)}
    .pay-title{font-size:36px;font-weight:800;color:white;margin-bottom:12px}
    .pay-buttons{display:flex;flex-direction:column;gap:12px;margin-bottom:12px}
    .pay-buttons button{width:320px;padding:12px;border-radius:15px;border:none;font-weight:800;font-size:18px;cursor:pointer}
    .check{background:#4CAF50;color:white}
    .cash-counter{background:#2196F3;color:white}
    .cash-mobile{background:#FF5722;color:white}
    .pay-msg{font-weight:700;color:white;font-size:20px;text-align:center;max-width:700px}

    /* Overlay / popup */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,0.3);display:flex;align-items:center;justify-content:center;z-index:1000}
    .popup{background:rgba(0,0,0,0.85);padding:26px;border-radius:18px;color:white;min-width:320px;text-align:center}
    .popup input{font-size:20px;padding:8px 12px;width:120px;text-align:center;border-radius:6px;border:none}
    .popup .ok{background:#4CAF50;color:white;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;margin-right:8px}
    .popup .cancel{background:#f44336;color:white;border:none;padding:10px 14px;border-radius:8px;cursor:pointer}

    /* small helpers */
    .hidden{display:none}

    /* Mobile payment overlay */
    .payment-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      flex-direction: column;
      color: white;
      font-weight: 700;
      font-size: 20px;
      text-align: center;
    }
    .payment-overlay img {
      max-width: 80%;
      max-height: 70%;
      border-radius: 20px;
      box-shadow: 0 8px 20px rgba(255,255,255,0.5);
      margin-bottom: 20px;
    }
    .payment-overlay .msg {
      font-size: 22px;
      color: #FFD700;
    }
  </style>
</head>
<body>
  <div class="root">
    <div class="container" id="app">
      <!-- Table selection page -->
      <div id="page-tables">
        <div class="title">âœ¨ Welcome to Tech Hotel âœ¨</div>
        <div class="instructions">ðŸ“Œ Instructions:<br>1. Select your table.<br>2. Select dishes with quantity.<br>3. Modify/delete items before payment.<br>4. Proceed to payment.</div>
        <div class="table-grid" id="tableGrid"></div>
      </div>

      <!-- Menu page -->
      <div id="page-menu" class="hidden">
        <div class="menu-layout">
          <div class="topbar"><button class="back-btn" id="backToTables">â¬… Back</button></div>
          <div class="menu-box" id="menuBox"></div>
          <div class="bottom-right"><button class="cart-btn" id="viewCart">ðŸ›’ View Cart</button></div>
        </div>
      </div>

      <!-- Cart page -->
      <div id="page-cart" class="hidden">
        <div class="cart-layout">
          <div class="cart-title">ðŸ›’ Cart for Table <span id="cartTableNum">0</span></div>
          <div class="cart-list" id="cartList"></div>
          <div class="total" id="totalLabel">Total Bill: â‚¹0</div>
          <div class="cart-controls">
            <button class="btn reorder" id="reorderBtn">ðŸ”„ Reorder</button>
            <button class="btn delete" id="deleteBtn">ðŸ—‘ Delete Order</button>
            <button class="btn payment" id="paymentBtn">ðŸ’³ Payment</button>
          </div>
        </div>
      </div>

      <!-- Payment page -->
      <div id="page-payment" class="hidden">
        <div class="payment-layout">
          <div class="pay-title">ðŸ’° Payment Options</div>
          <div class="pay-buttons">
            <button class="check" id="checkItemsBtn">âœ… Check Items</button>
            <button class="cash-counter" id="cashCounterBtn">ðŸ’µ Cash at Counter</button>
            <button class="cash-mobile" id="cashMobileBtn">ðŸ“± Cash via Mobile</button>
          </div>
          <div class="pay-msg" id="payMsg"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Overlay area for popups -->
  <div id="overlayRoot" class="hidden"></div>

  <script>
    // App state
    let selectedTable = 0;
    const cart = new Map();
    const priceMap = new Map();

    // Elements
    const pageTables = document.getElementById('page-tables');
    const pageMenu = document.getElementById('page-menu');
    const pageCart = document.getElementById('page-cart');
    const pagePayment = document.getElementById('page-payment');
    const tableGrid = document.getElementById('tableGrid');
    const menuBox = document.getElementById('menuBox');
    const viewCartBtn = document.getElementById('viewCart');
    const backToTables = document.getElementById('backToTables');
    const cartList = document.getElementById('cartList');
    const totalLabel = document.getElementById('totalLabel');
    const cartTableNum = document.getElementById('cartTableNum');
    const reorderBtn = document.getElementById('reorderBtn');
    const deleteBtn = document.getElementById('deleteBtn');
    const paymentBtn = document.getElementById('paymentBtn');
    const checkItemsBtn = document.getElementById('checkItemsBtn');
    const cashCounterBtn = document.getElementById('cashCounterBtn');
    const cashMobileBtn = document.getElementById('cashMobileBtn');
    const payMsg = document.getElementById('payMsg');
    const overlayRoot = document.getElementById('overlayRoot');

    // Menu data
    const menuData = [
      {section: 'Breakfast', items:[ ['Idli',20],['Vada',25],['Pongal',30],['Upma',25],['Dosa',35], ['Masala Dosa',50],['Medu Vada',30],['Rava Upma',30],['Poori',35] ]},
      {section: 'Lunch', items:[ ['Steamed Rice',30],['Tamarind Rice',35],['Lemon Rice',30],['Curd Rice',30], ['Veg Biryani',60],['Paneer Butter Masala',70],['Dal Tadka',40],['Mix Veg',50] ]},
      {section: 'Dinner', items:[ ['Dosa',35],['Rava Dosa',40],['Ghee Dosa',50],['Pesarattu',45],['Set Dosa',40], ['Chapati',10],['Paneer Bhurji',60],['Veg Pulao',50] ]},
      {section: 'Drinks', items:[ ['Lemon Juice',20],['Coconut Water',25],['Buttermilk',15],['Coffee',20],['Tea',10] ]},
      {section: 'Snacks', items:[ ['Samosa',15],['Vada Pav',20],['Pakora',25],['Spring Roll',35] ]},
      {section: 'Desserts', items:[ ['Gulab Jamun',15],['Rasgulla',15],['Ice Cream',30],['Halwa',20] ]}
    ];

    menuData.forEach(sec => sec.items.forEach(it => priceMap.set(it[0], it[1])));

    // Build table buttons
    for(let i=1;i<=10;i++){
      const btn = document.createElement('button');
      btn.className='table-btn';
      btn.textContent='Table '+i;
      btn.addEventListener('click',()=>{ selectedTable = i; showMenuPage(); requestFullscreenSafe(); });
      tableGrid.appendChild(btn);
    }

    function showPage(page){
      pageTables.classList.add('hidden');
      pageMenu.classList.add('hidden');
      pageCart.classList.add('hidden');
      pagePayment.classList.add('hidden');
      page.classList.remove('hidden');
    }

    function showMenuPage(){ buildMenu(); showPage(pageMenu); }

    backToTables.addEventListener('click',()=>{ showPage(pageTables); });

    function buildMenu(){
      menuBox.innerHTML='';
      menuData.forEach(sec=>{
        const secEl = document.createElement('div'); secEl.className='section';
        const h2 = document.createElement('h2'); h2.textContent = sec.section;
        secEl.appendChild(h2);
        const grid = document.createElement('div'); grid.className='items-grid';
        sec.items.forEach(([name,price])=>{
          const btn = document.createElement('button'); btn.className='item-btn';
          btn.textContent = `${name} - â‚¹${price}`;
          btn.addEventListener('click',()=>showQuantityPopup(name,true));
          grid.appendChild(btn);
        });
        secEl.appendChild(grid);
        menuBox.appendChild(secEl);
      });
    }

    viewCartBtn.addEventListener('click',()=>{ refreshCartList(); cartTableNum.textContent=selectedTable||0; showPage(pageCart); });

    function refreshCartList(){
      cartList.innerHTML='';
      for(const [name,qty] of cart.entries()){
        const sub=(priceMap.get(name)||0)*qty;
        const el=document.createElement('div');
        el.textContent=`${name} x ${qty} = â‚¹${sub}`;
        el.style.padding='8px 6px'; el.style.borderBottom='1px solid #ddd';
        el.dataset.item=name;
        el.addEventListener('click',()=>{ document.querySelectorAll('#cartList div').forEach(d=>d.style.background=''); el.style.background='#e6e6e6'; });
        cartList.appendChild(el);
      }
      updateTotal();
    }

    function updateTotal(){ let total=0; for(const [name,qty] of cart.entries()) total+=(priceMap.get(name)||0)*qty; totalLabel.textContent=`Total Bill: â‚¹${total}`; }

    reorderBtn.addEventListener('click',()=>showMenuPage());

    deleteBtn.addEventListener('click',()=>{
      const selected=document.querySelector('#cartList div[style*="background"]');
      if(!selected){ showInternalMsg('Select item to delete'); return; }
      const item=selected.dataset.item;
      showQuantityPopup(item,false);
    });

    paymentBtn.addEventListener('click',()=>{ showPage(pagePayment); payMsg.textContent=''; });

    function showInternalMsg(msg){
      const overlay=document.createElement('div'); overlay.className='overlay';
      const popup=document.createElement('div'); popup.className='popup';
      popup.innerHTML=`<div style="font-weight:800;color:yellow">${msg}</div>`;
      overlay.appendChild(popup); document.body.appendChild(overlay);
      setTimeout(()=>document.body.removeChild(overlay),1500);
    }

    function showQuantityPopup(itemName,isAdd){
      overlayRoot.innerHTML=''; overlayRoot.classList.remove('hidden'); overlayRoot.classList.add('overlay');
      const popup=document.createElement('div'); popup.className='popup';
      const label=document.createElement('div'); label.style.fontSize='20px'; label.style.marginBottom='10px';
      label.textContent=(isAdd?`Enter quantity for `:`Enter quantity to delete for `)+itemName;
      const input=document.createElement('input'); input.type='number'; input.value='1'; input.min='1';
      const btnBox=document.createElement('div'); btnBox.style.marginTop='12px';
      const ok=document.createElement('button'); ok.className='ok'; ok.textContent=isAdd? 'Add':'Delete';
      const cancel=document.createElement('button'); cancel.className='cancel'; cancel.textContent='Cancel';
      btnBox.appendChild(ok); btnBox.appendChild(cancel);
      popup.appendChild(label); popup.appendChild(input); popup.appendChild(btnBox);
      overlayRoot.appendChild(popup);

      ok.addEventListener('click',()=>{
        try{
          const qty=parseInt(input.value); if(isNaN(qty)||qty<=0) throw 'Invalid';
          if(isAdd){ cart.set(itemName,(cart.get(itemName)||0)+qty); refreshCartList(); showOverlayMessage(`${qty} x ${itemName} added!`); }
          else{
            if(!cart.has(itemName)){ showOverlayMessage(`${itemName} not in cart!`); return; }
            const cur=cart.get(itemName);
            if(qty>cur){ showOverlayMessage(`Cannot delete more than ${cur}`); return; }
            if(qty===cur) cart.delete(itemName); else cart.set(itemName,cur-qty);
            refreshCartList(); showOverlayMessage(`${qty} removed from ${itemName}`);
          }
        }catch(e){ showOverlayMessage('Enter a valid positive number!'); }
      });
      cancel.addEventListener('click',()=>{ overlayRoot.innerHTML=''; overlayRoot.classList.add('hidden'); });
    }

    function showOverlayMessage(msg){
      overlayRoot.innerHTML=''; overlayRoot.classList.remove('hidden'); overlayRoot.classList.add('overlay');
      const popup=document.createElement('div'); popup.className='popup';
      popup.innerHTML=`<div style="font-weight:800;color:yellow">${msg}</div>`;
      overlayRoot.appendChild(popup);
      setTimeout(()=>{ overlayRoot.innerHTML=''; overlayRoot.classList.add('hidden'); },1500);
    }

    checkItemsBtn.addEventListener('click',()=>{ showPage(pageCart); });
    function computeTotal(){ let total=0; for(const [name,qty] of cart.entries()) total+=(priceMap.get(name)||0)*qty; return total; }

    cashCounterBtn.addEventListener('click',()=>{
      const total=computeTotal();
      payMsg.innerHTML=`ðŸ’³ Table ${selectedTable}<br>Thank you for visiting Tech Hotel!<br>Your bill is â‚¹${total}.<br>Please take it and give it to the counter.<br>Printing your bill now...`;
      cart.clear(); setTimeout(()=>{ showPage(pageTables); },3000);
    });

    // ðŸ’¥ Mobile payment overlay with 15 sec auto-hide
    cashMobileBtn.addEventListener('click',()=>{
      const total=computeTotal();
      cart.clear();

      const overlay = document.createElement('div');
      overlay.className='payment-overlay';

      const img = document.createElement('img');
      img.src='cash.jpeg';
      overlay.appendChild(img);

      const msg = document.createElement('div');
      msg.className='msg';
      msg.innerHTML = `ðŸ“± Table ${selectedTable}<br>Amount: â‚¹${total}<br>Scan QR or pay via mobile`;
      overlay.appendChild(msg);

      document.body.appendChild(overlay);

      setTimeout(()=>{
        document.body.removeChild(overlay);
        showPage(pageTables);
      },15000); // 15 seconds
    });

    function requestFullscreenSafe(){
      const el=document.documentElement;
      if(el.requestFullscreen) el.requestFullscreen().catch(()=>{});
      else if(el.webkitRequestFullscreen) el.webkitRequestFullscreen();
    }
    window.addEventListener('keydown',(ev)=>{ if(ev.code==='Escape') ev.preventDefault(); });
    window.addEventListener('load',()=>{ try{ requestFullscreenSafe(); }catch(e){} });
    showPage(pageTables);
  </script>
</body>
</html>
